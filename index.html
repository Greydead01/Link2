<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Antivirus</title>

<style>
    body {
        margin: 0;
        font-family: Arial, Helvetica, sans-serif;
        background: white;
        color: black;
        text-align: center;
        overflow: hidden;
    }

    h1 {
        color: red;
        margin: 20px 0;
        font-size: 2rem;
    }

    #container {
        height: calc(100vh - 80px);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    button {
        background: red;
        color: white;
        border: none;
        padding: 20px 50px;
        font-size: 1.5rem;
        border-radius: 10px;
        cursor: pointer;
    }

    #scanText {
        margin-top: 20px;
        font-weight: bold;
    }

    #progressBox {
        width: 80%;
        height: 20px;
        border: 2px solid red;
        margin-top: 15px;
        display: none;
    }

    #progressBar {
        height: 100%;
        width: 0%;
        background: red;
    }

    .red {
        color: red;
        font-weight: bold;
    }

    #results {
        margin-top: 20px;
    }

    #virusList {
        margin-top: 10px;
        height: 200px;
        overflow: hidden;
        font-family: monospace;
        display: none;
    }

    #blackout {
        position: fixed;
        inset: 0;
        background: black;
        display: none;
        z-index: 10;
        pointer-events: none;
        justify-content: center;
        align-items: center;
        color: red;
        font-size: 3rem;
        font-weight: bold;
    }

    video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    /* Canvas voor glitch edge particles */
    #glitchCanvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 20;
    }
</style>
</head>

<body>

<h1>ANTIVIRUS</h1>

<canvas id="glitchCanvas"></canvas>

<div id="container">
    <button id="scanBtn">Scan</button>
    <div id="scanText"></div>

    <div id="progressBox">
        <div id="progressBar"></div>
    </div>

    <div id="results"></div>
    <div id="virusList"></div>
</div>

<div id="blackout"></div>

<audio id="sound" src="media/sound.mp3" preload="auto"></audio>

<script>
console.log("JS LOADED");

const scanBtn = document.getElementById("scanBtn");
const scanText = document.getElementById("scanText");
const progressBox = document.getElementById("progressBox");
const progressBar = document.getElementById("progressBar");
const results = document.getElementById("results");
const virusList = document.getElementById("virusList");
const blackout = document.getElementById("blackout");
const sound = document.getElementById("sound");

// --- Glitch edge particles setup ---
const canvas = document.getElementById('glitchCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

class EdgeParticle {
    constructor() {
        this.edge = Math.floor(Math.random() * 4); // top/right/bottom/left
        this.reset();
    }

    reset() {
        this.baseSize = Math.random() * 5 + 3; // 3-8px
        this.size = this.baseSize;
        this.alpha = Math.random() * 0.7 + 0.3;
        this.colorOptions = ['#0f0','#f00','#0ff','#ff0','#f0f','#0ff','#fff','#ff8000'];
        this.color = this.colorOptions[Math.floor(Math.random()*this.colorOptions.length)];
        this.speed = Math.random() * 1 + 0.2;

        if(this.edge===0){ this.x=Math.random()*canvas.width; this.y=0; this.vx=(Math.random()-0.5)*0.5; this.vy=0; }
        else if(this.edge===1){ this.x=canvas.width; this.y=Math.random()*canvas.height; this.vx=0; this.vy=(Math.random()-0.5)*0.5; }
        else if(this.edge===2){ this.x=Math.random()*canvas.width; this.y=canvas.height; this.vx=(Math.random()-0.5)*0.5; this.vy=0; }
        else { this.x=0; this.y=Math.random()*canvas.height; this.vx=0; this.vy=(Math.random()-0.5)*0.5; }
    }

    update() {
        // beweeg licht langs rand
        this.x += this.vx;
        this.y += this.vy;

        // flikker en pulse size
        this.alpha = Math.random()*0.8 + 0.2;
        this.size = this.baseSize + Math.random()*3; // pulseren

        // glitch jump naar binnen
        if(Math.random() < 0.02){ // 2% kans per frame
            if(this.edge===0) this.y += Math.random()*20;
            else if(this.edge===1) this.x -= Math.random()*20;
            else if(this.edge===2) this.y -= Math.random()*20;
            else this.x += Math.random()*20;
        }

        // reset als buiten canvas
        if(this.x<-10 || this.x>canvas.width+10 || this.y<-10 || this.y>canvas.height+10){
            this.reset();
        }

        // verander random kleur af en toe
        if(Math.random() < 0.05){
            this.color = this.colorOptions[Math.floor(Math.random()*this.colorOptions.length)];
        }
    }

    draw() {
        ctx.fillStyle = this.color;
        ctx.globalAlpha = this.alpha;
        ctx.fillRect(this.x, this.y, this.size, this.size);
        ctx.globalAlpha = 1;
    }
}

// setup en animate blijven hetzelfde:
const edgeParticles = [];
for(let i=0;i<120;i++){ edgeParticles.push(new EdgeParticle()); }

function animateEdgeParticles(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    edgeParticles.forEach(p => { p.update(); p.draw(); });
    requestAnimationFrame(animateEdgeParticles);
}

// --- Scan knop ---
scanBtn.addEventListener("click", () => {
    scanBtn.style.display = "none";
    scanText.textContent = "SCANNING SCHOOL DATABASE...";
    progressBox.style.display = "block";

    const duration = 5000;
    const start = performance.now();

    function animate(now){
        const elapsed = now - start;
        const t = Math.min(elapsed / duration, 1);
        const eased = t<0.5?2*t*t:1-Math.pow(-2*t+2,2)/2;
        progressBar.style.width = (eased*100)+"%";
        if(t<1){ requestAnimationFrame(animate); }
        else { showScanResults(); }
    }
    requestAnimationFrame(animate);
});

function showScanResults(){
    progressBox.style.display="none";
    scanText.textContent="";

    results.innerHTML=`
        <p>Scanned:</p>
        <p>* Halls</p>
        <p>* Classrooms</p>
        <p>* Students</p>
    `;

    setTimeout(()=>{
        results.innerHTML=`
            <p><span class="red">STATUS:</span> INFECTED</p>
            <p>Spread Started.</p>
            <p><span class="red">NEXT PHASE:</span> 48h</p>
            <p>TOMORROW - SMARTSCHOOL (Midday)</p>
        `;
        setTimeout(showViruses,6000); // 6 seconden pauze
    },2000);
}

function showViruses(){
    results.innerHTML+=`<p>Viruses found:</p>`;
    virusList.style.display="block";

    const viruses=[
        "Trojan.Win32.Agent","Trojan.Win32.Backdoor","Trojan.Win32.Injector",
        "Trojan.Win32.Dropper","Trojan.Win32.Keylogger","Trojan.Win32.Stealer",
        "Trojan.Win32.Loader","Trojan.Win32.Hidden","Trojan.Win32.Persistence",
        "Trojan.Script.Agent","Trojan.Macro.Dropper","Trojan.PowerShell.Agent",
        "Trojan.Android.Agent","Trojan.Generic"
    ];

    let i=0;
    const scroll=setInterval(()=>{
        virusList.innerHTML+=viruses[i%viruses.length]+"<br>";
        virusList.scrollTop=virusList.scrollHeight;
        i++;
    },25);

    setTimeout(()=>{
        clearInterval(scroll);
        fadeToBlack();
    },3000);
}

function fadeToBlack(){
    blackout.style.display="flex";
    blackout.innerHTML=`<video src="media/video.mp4" autoplay muted></video>`;

    try{sound.play();}catch{}

    setTimeout(showSoon,7000);
}

function showSoon(){
    blackout.innerHTML="";
    animateEdgeParticles(); // start glitch edge particles

    // placeholder sound effect
    // const soonSound = new Audio('media/soonEffect.mp3');
    // soonSound.play();

    const text="SOON";
    let i=0;
    const typer=setInterval(()=>{
        blackout.textContent+=text[i];
        i++;
        if(i>=text.length) clearInterval(typer);
    },700);
}
</script>

</body>
</html>
